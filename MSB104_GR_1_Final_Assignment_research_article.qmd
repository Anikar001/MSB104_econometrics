---
title: "Regional Inequalities and economic growth; cross section and times series analysis"
author: "Anine Therese Karlsen & Mona Lisa Jones"
format: pdf
abstract: "This assignment aims to acquire, process, and analyze sub-national GDP and population data for a subset of European countries. Firstly (assignment 1), Calculateing GDP per capita and exploreing regional inequity using various descriptive statistics and visualizations.Secondly (assignment 2), examining the relationship between regional development and inequality, employing cross sectional estimation techniques for the year 2010.Lastly exploring alternative functional forms and implementing panel estimation to analzise the relationship between regional development inequality"
editor: visual
bibliography: [Regional_inequality_23.bib, econometrics.bib]
page-layout: full
number-sections: true
papersize: a4
csl: apa.csl
---

```{r}
#| label: setup
#| output: false
#| echo: false

library(tidyverse)
library(tinytex)
library(dplyr)
library(ggplot2)
library(readxl)
library(magrittr)
library(vtable)
library(lubridate)
library(dineq)
library(huxtable)
library(plm)
```

# Introduction

While national GDP and GDP per capita are vital indicators of a country's aggregate economic health, they do not shed light on how wealth or income is distributed among its residents. A high national GDP can, paradoxically, coexist with pockets of regional deprivation [@lessmann2017].

The truth of this statement becomes more evident when taking a closer look at sub-national data. Regional wealth disparities are of prime concern, especially when crafting policies for equitable growth [@lessmann2017]. A country's macro-level prosperity does not automatically guarantee that all its regions partake equally in this wealth. By studying smaller regions within a country, it is possible to get a more nuanced narrative about the state of regional economic disparities [@lessmann2017].

Using time series data and cross-sectional observations we investigate Economic growth and Inequality trends in Portugal, France, Hungary, Slovenia and Denmark in the time period 2000 to 2020. The aims are to acquire, process, and analyse sub-national GDP, GINI and population data for a subset of European countries.

The primary objective is to gain knowledge of econometric methods used for science in business through our given topic. Subsequently, econometric terms and definitions are explained in greater detail than it normally would in similar papers. Using GDP per capita and the Gini coefficient. Moreover, both are vital indicators in the field of economics and are frequently used, in a wide array of studies. Furthermore, to analyse and interpret the economic conditions and social disparities of different regions or countries. Their analysis provides crucial insights for policymakers, economists, and researchers in shaping and evaluating the effectiveness of socio-economic policies.

The research question ***"What are the regional economic growth and inequality measurements from 2000 to 2020, in selected European countries and how does other*** ***determinants affect the results?"*** is key in guiding our study. Setting a solid foundation for a comprehensive study that not only measure our given parameters, but also a critically examination of the role of determinants such as transportation infrastructure and education. @lessmann2017 states that transportation costs play an important role in agglomeration and income, and reduced transportation costs as a determinant of regional inequality.

The sructure of our study is methodically designed to facilitate this exploration. In part 1A and B we calculate GDP per capita and explore regional inequality using various descriptive statistics and visualizations such as panel data (***Assignment_1***). In part 2A and B we use cross sectional method to examine the relationship between regional development and inequality, employing cross sectional estimation techniques for the year 2010 (***Assignment_2***). Furthermore, exploring alternative functional forms and implementing panel estimation to analzise the relationship between regional development inequality (***Assignment_3***).

Lastly, it is worth noting potential limitations may arise due to the use of ChatGPT and ChatGPT PDF, which have been utilized as tools to gain understanding and extract knowledge from academic papers, as well as to explain econometric terms and definitions. The text generated by these tools has been cross-checked to the best of our knowledge with our textbook and Andre Seidel, lecturer and author of 'Regional Inequality, Convergence, and Its Determinants -- A View from Outer Space' (2017). Despite these precautions, there may be instances where incorrect information was provided, and some errors could have been overlooked. The text has been meticulously rewritten to fit our style of writing, ensuring consistency and accuracy throughout our study.

# Literature Review: Regional Economic Growth, Inequality and determines (2000-2020)

Why some places grow and prosper is a fundamental question in social science research. This question motivated Adam Smith's work, *An Inquiry into the Nature and Causes of the Wealth of Nations,* (Smith [1863](https://link-springer-com.galanga.hvl.no/article/10.1007/s11187-014-9574-4#ref-CR32 "Smith, A. (1863). An inquiry into the nature and causes of the wealth of nations. Edinburgh: A. & C Black.")) and has been a major influence of the *new economic geography* [@feldman2014]*. Furthermore,* regional growth and inequality have been important topics of research in Europe for many years. In recent decades, the European Union implemented policies aimed at reducing regional disparities and promoting economic growth across its member states. Furthermore, despite these efforts, significant disparities in income and economic development persist across regions in Europe [@lessmann2017].

**Economic Growth and Regional Disparities**

Regional growth in Europe exhibits a complex pattern, influenced significantly by factors such as geography, human capital, and economic policies. Lessmann and Seidel's research offers insights into these dynamics, highlighting the persistence of income disparities, across regions despite overarching economic advancement [@lessmann2017]. Wealthier nations like Denmark tend to experience quicker regional convergence, a phenomenon supported by Gennaioli et al.'s findings [@gennaioli2014].

**Financial crisis, and EU membership for Slovakia and Hungary**

The 2008 financial crisis significantly disrupted regional growth and exacerbated income inequalities across Europe. Nguyen et al. highlight that financial turmoil typically leads to increased income disparity; a trend observed globally [@nguyen2022].

Focusing on Europe, we expect varied regional economic performances, especially when comparing Eastern European countries such as Hungary and Slovakia to their Western counterparts. Given the role of capital market regulations in promoting regional convergence, outlined by Gennaioli et al., we anticipate a potential growth acceleration. In particular for Eastern European countries following their EU accession in 2003 and 2004 [@gennaioli2014]. However, the financial crisis and subsequent labour market shifts may also have influenced these trends.

EU membership provided Slovakia and Hungary with resources for economic recovery, while Western European countries, including Denmark, Portugal, and France, likely experienced significant economic declines due to the financial crisis, a pattern possibly mirrored in the recent COVID-19 pandemic. In particular Portugal as the crisis hit them harder. These complexities highlight the importance of a detailed analysis to understand regional economic growth and inequality in challenging times.

**Regional inequality**

Another affect that surprised us was that the economic crisis led to increase inequality. The study "*the effects of financial crisis on regional inequality*" indicate any type of financial crisis results in higher income inequality [@nguyen2022].

@lessmann2017 regional inequality study address the importance of studying these aspects. Its potential consequences, such as political tensions that can undermine social and political stability [@lessmann2017]. The paper also discusses the relationship between regional inequality and personal income inequality and conflict risk.

**Determinants of regional inequality**

Geographic characteristics stand out as pivotal, with the natural and topographical elements of a region significantly swaying income distributions [@lessmann2017].

Urbanization emerges as a crucial determinant, where bustling, populous around urban centers usually enjoy elevated income levels, contrasting starkly with the often-stark disparities witnessed in more rural and secluded areas [@lessmann2017].

*Transport infrastructure and Education*

Transport infrastructure plays a central role in shaping regional economic landscapes. Improved connectivity fosters economic activities, reduces travel time, and enhances accessibility to markets and resources. Studies indicates that regions with robust transport infrastructure tend to attract more investments, generate employment, and ultimately contribute to regional prosperity.

[@lessmann2017] also discusses the determinant of Education in the context of human capital. The study mentions that human capital is the most important determinant of differences in regional development within countries. The study also notes that human capital creates positive externalizes, which can spill over regional boundaries. Moreover, the quality of human capital within countries, as measured by the secondary-school enrollment rate, can decrease regional inequality by facilitating regional spillovers and convergence. Lastly, promoting internal migration.

**Expected Inverted U- and N shaped curves**

Furthermore, @lessmann2017 provides us with insights into the inverted U-shaped relationship between regional inequality and the level of economic development in different country groups [@lessmann2017]. The inverted U-shape also referred to as Kuznets Curve suggests that as an economy develops, regional inequality initially rises, reaches a peak, and then starts to decline.

@lessmann2017 paper also finds that there is an N-shaped relationship between regional inequality and economic development, which means that regional inequality increases again after the inverted U-shaped pattern has been completed [@lessmann2017].

@iammarino2019 discusses regional inequalities in European countries. It presents evidence that inter-regional inequality has been increasing in the European Union since the turn of the millennium. The authors argue that this is due to the existence of several groups of regional economies in Europe that are structurally very different from one another [@iammarino2019]. Additionally, the authors argue that there are some countries in the EU that are more evenly developed than others, and that a map of under performance or over-performance means less in a high-income but evenly developed country, such as in Denmark in our case [@iammarino2019]. On the other hand, France has been a subject of discussion and policy making for many years, regarding its well-known pockets of extreme wealth in regions such as Cap d'Antibes.

Overall, it is evident that regional economic growth and inequality in Europe from 2000 to 2020 have been influenced by a constellation of factors, with transport infrastructure and education emerging as significant determinants. Earlier studies provide us with a fundamental understanding of these dynamics, while also highlighting the nuanced impacts of economic crises on regional disparities. The integration of transport infrastructure and education into this discourse adds an additional layer of complexity, underscoring its potential as a catalyst for regional development and equality.

# Data and Descriptive

Trough Eurostat, we download the datasets nama_10r_3gdp , demo_r_pjanggr3, demo_r_mlifexp, tran_r_net and edat_lfse_04 as csv files. Selecting our countries of study and timeperiod. Selecting the required NUTS level and specified the data to be in million Euro.

## GDP

The GDP dataset provides insights into GDP at regional level using the NUTS classification system. It furnishes GDP values in both current prices and adjusted for inflation, with figures given in purchasing power standards (PPS) to account for price level differences between countries. The data is mostly structured by year and region @database.

The GDP at market prices represents the final result of production activities of resident producer units within a region or nation. It is calculated as the sum of the gross value added across various institutional sectors or industries. Furthermore, augmented by taxes and reduced by subsidies on products (which are not allocated to specific sectors or industries) @database. This also balances out in the total economy production account. In terms of methodology, while national accounts compile GDP from the expenditure side, regional accounts don't adopt this approach due to the complexities of accurately mapping inter-regional flows of goods and services.

The different measures for the regional GDP are absolute figures in € and Purchasing Power Standards (PPS), figures per inhabitant and relative data compared to the EU Member States average @database.

## Population

Eurostat's records annual population data with NUTS classification. Our dataset includes information on births, deaths, net migration, and may also include demographic information on age and gender. Displayed in a year-by-region format, with yearly interval updates @database.

Eurostat's primary source for yearly demographic data at the regional level stems from the Unified Demography (Unidemo) project. The project covers 37 countries and is the central repository for demographic and migration-related data @database. As well as, specific metrics gathered under UNIDEMO encompass population counts at the close of the calendar year and events such as births and deaths occurring within that year @database. Additionally, data on marriages, divorces, and migration flows are recorded .

For the purpose of this research, the demographic data references the NUTS 2016 classification, which provides a detailed breakdown of the European Union's territory @database.

## Demographic (Nuts 2)

Statistics on population change (demo_r_mlifexp) and on population structure was collected from Euro Stat [@database]. Used to monitor demographic behavior within political, economic, social and cultural contexts at NUTS 2 level. Same policy and demographic classifications as previous population data set applies.

## Transportation Infrastructure (Nuts 2)

This data-set (tran_r_net) presents recent data on the inland transport network of the European Union (EU), EFTA and candidate countries presenting motorways, railways and inland waterways [@database]. Furthermore used as a varable of of interest (MLR) in our section growth and inequality. Moreover, to excamine if evolution of the transport network is closely linked to the general development of the economy.

The collected data are compiled by the competent national authorities. Reported annually be the National Statistical Office, the Civil Aviation Authorities (air transport), the Ministry of Transport (inland waterways, railway and road networks, victims), and the National Maritime Administration (maritime transport) [@database].

## Education (Nuts 2)

This data set (edat_lfse_04) contains population by educational attainment level, sex and NUTS 2 regions (%). Including data on the highest level of education successfully completed by the individuals of a given population. Furthermore, data on young people neither in employment nor in education and training -- NEET, early leavers from education and training and the labor status of young people by years since completion of highest level of education. Calculated as annual averages of quarterly EU Labor Force Survey data (EU-LFS).

## NUTS classification

The Nomenclature of Territorial Units for Statistics (NUTS) offers a stratified system to segment the economic territory of the EU and UK to facilitate the consistent collection and harmonization of regional statistics across Europe. The NUTS regions range from NUTS 0 Country level to NUTS 3 small units such as municipalities level @eurostat2023a.  

```{r}
#| echo: false
#| output: false

# This section of the code is dedicated to adding data to RStudio. We will import the datasets into the RStudio environment for further analysis, manipulation, and visualization using R.

# Data for population
pop_data <- read_csv("Raw_data/demo.gz")

# Data for GDP
gdp_data <- read_csv("Raw_data/nama.gz")
```

```{r}
#| echo: false
#| output: false
# Renaming and selecting the variables we want to keep
# We're doing this in order to make the datasets more clean and easy to read

gdp_data_01 <- gdp_data |>
  select(geo, year = TIME_PERIOD, GDP = OBS_VALUE)

pop_data_01 <- pop_data |>
  select(geo, year = TIME_PERIOD, population = OBS_VALUE)
```

In this part we will report and interpret different types of essential descriptive statistics. Measuring regional income inequality is challenging due to heterogeneity of regions [@lessmann2017]. The number of regions in our data set varies largely in size and population. Since the focus of this paper is purely growth and changes in inequities over time, the variations of size and population density becomes a minor issue because the country-level territorial heterogeneity is fixed [@lessmann2017].

"Interest in income inequality has led to the development of several ways of measuring it. Two types of measures are of interest in this paper----static and dynamic. *Static measures* provide a snapshot (cross sectional) of these inequalities at a point of time whereas the dynamic *measures capture historical trends* (Paneldata)*.*" [@wooldridge2020]

By using figures, we can visualize the GDP per capita, and look at how it varies among the different regions. In these figures, a line represent one NUTS 3 region.

## Descriptive statistics

**Mean**

We calculate the mean to provide a representative value for the dataset, facilitating understanding of its central tendency and serving as a benchmark against which deviations and anomalies can be assessed, in later steps when building and interpreting regression models [@wooldridge2020].

**MMR**

Comparing the GRDP (gross regional domestic product) per capita of the region with the highest income to the region with the lowest income (minimum per capita GRDP) provides a measure of the range of these disparities. If this measure is small (close to 1), then it would mean that the different regions have relatively equal incomes [@wooldridge2020]. If this measure is large, then the interpretation is more problematic, as it does not tell us if the high ratio is due to substantial variation in the distribution of per capita GDRPs or the presence of outliers. Nevertheless, maximum to minimum ratio (MMR) provides a quick, easy to comprehend, and politically powerful measure of regional income inequality.

**Standard diviation (SD)**

Calculating SD to quantify the dispersion or variability of a data set around its mean. Helping us assess the degree of uncertainty, variability, or risk associated with an economic variable or parameter, which is crucial for understanding the reliability of estimations and predictions [@wooldridge2020].

**Median**

The median serves as a robust measure of central tendency, especially when a dataset may have outliers or is skewed. Unlike the mean, the median is not influenced by extreme values and, thus, can provide a clearer picture of the "typical" value in situations where the data distribution is not symmetrical [@wooldridge2020].

### **Time series (Panel data)**

### Cross sectional analysis

### Simple linear regression

### Multiple linear regression

## Part 1A: Sub-national GDP and GDP per Capita

### GDP per Capita Calculation

The formula for calculating GDP per Capita is as follows:

$y_i=GDP_i/population_i$

```{r}
#| echo: false
#| output: false

# Merging the datasets pop_data and gdp_data into one dataset by joining the variables "geo" and "year". 

merged_data <- left_join(pop_data_01, gdp_data_01, join_by(geo, year))

# Select Only NUTS 3 Regions
# Filter for specific countries, this will be useful when we will find the GDP per capita for the countries seperately

merged_data <- merged_data |>
  filter(
    startsWith(as.character(geo), "PT") | 
    startsWith(as.character(geo), "FR") | 
    startsWith(as.character(geo), "HU") |
    startsWith(as.character(geo), "SK") | 
    startsWith(as.character(geo), "DK")
  ) %>%
  
# Filter rows where 'geo' column has more than 4 characters to select only NUTS3 regions
  filter(nchar(as.character(geo)) > 4) %>%
  
# Rename 'geo' column to 'id_nuts3'
  rename(id_nuts3 = geo)
```

```{r}
#| echo: false
#| output: false

# Calculating GDP per Capita

GDP_per_capita <- merged_data |>
  mutate(
    GDP_per_capita = round(100*GDP/population, digits = 2)
  )

# we use *100 in order to get the gdp per capita as a percentage, and digits = 2 to limit it down to two decimals
```

After calculating the GDP per capita for all NUTS 3 regions within the chosen countries, we can see that there is a large spread between the figures for the various regions. We want to look at regional inequity; in order to do this in a valuable way, countries are divide. Furthermore, gaining important insights on regional differences and utilize. Later to discuss national policy on equity and sustainable economic development in regions.

### GDP per capita Portugal

```{r}
#| echo: false
#| output: false

# Making a dataset that only contains data from Portugal
# Use the na.omit function in order to remove NA values, cant make ggplot with NA values. 

Portugal_data <- GDP_per_capita |>
  filter(grepl("PT", id_nuts3)) |>
  na.omit(Portugal_data)
```

```{r}
#| echo: false

# Making a figure using ggplot that shows us variations of GDP per capita across the different NUTS 3 regions in Portugal. 

Portugal_data_plot <- ggplot(Portugal_data, aes(x = year, y = GDP_per_capita, color = id_nuts3)) +
  geom_line() +
  labs(title="Figure 1: GDP per Capita for Portugal", 
       x="Year",
       y="GDP per Capita") +
  theme(legend.position="none")

# Print out the figure

print(Portugal_data_plot)
```

```{r}
#| echo: false

# Calculate summary statistics for Portugal, chosing only GDP per capita 
summary_stats_portugal <- sapply(Portugal_data["GDP_per_capita"], function(x) c(
  mean = mean(x),
  median = median(x),
  std_dev = sd(x),
  minimum = min(x),
  maximum = max(x)
))

# Print the summary statistics
print(summary_stats_portugal)
```

By looking at figure for Portugal, we can see that the GDP per capita in Portugal's regions appears to be fairly consistent. There is however some regional variability. We can see signs of urbanisazation where the regions around the big cities like Lisbon have a higher GDP per capita compared to some more rural areas. Since Lisbon is the capital of Portugal, there is probably a higher concentration of industries, making it a economic center (which again makes the GDP per capita higher).

To continue, we can see that the mean is a little higher that the median, something that might indicate that regions like Lisbon are pulling up the average. If we compare the standard derivation for Portugal with the other countries, we'll see that is fairly low in comparison. This might mean that there is not a lot of variability between the GDP per capita across different regions in Portugal. The gap between minimum and maximum is also low compared to other countries, something that'll also show us that the economic disparity in Portugal might not be as high as it is in other countries.

### GDP per capita France

```{r}
#| echo: false
#| output: false

# Making a dataset that only contains data from France

France_data <- GDP_per_capita |>
  filter(grepl("FR", id_nuts3)) |>
  na.omit(France_data)
```

```{r}
#| echo: false

# Making a figure using ggplot that shows us variations of GDP per capita across the different NUTS 3 regions in France. 

France_data_plot <- ggplot(France_data, aes(x = year, y = GDP_per_capita, color = id_nuts3)) +
  geom_line() +
  labs(title="Figure 1: GDP per Capita for France", 
       x="Year",
       y="GDP per Capita") +
  theme(legend.position="none")

print(France_data_plot)
```

```{r}
#| echo: false

# Calculate summary statistics for France, chosing only GDP per capita 
summary_stats_france <- sapply(France_data["GDP_per_capita"], function(x) c(
  mean = mean(x),
  median = median(x),
  std_dev = sd(x),
  minimum = min(x),
  maximum = max(x)
))

# Print the summary statistics
print(summary_stats_france)
```

When looking at the figure for France, we see some regions have a much higher GDP per capita compared to the other regions. The regions with the highest GDP per capita for all years is the île-de-France region, one that also includes Paris. This significant difference between the regions with the highest GDP per capita and the lowest, shows us that there is a high concentration of economic activity and wealth in a few urban regions. Similar to Portugal, we see differences between urban and rural regions.

Just as in Portugal, there is also a higher mean in France as well. On the contary the data in France has higher standard derivation, and the difference between minimum and maximum is larger. This strengthens earlier figures showing, some regions having a high concentration of wealth.

### GDP per capita Hungary

```{r}
#| echo: false
#| output: false

# Making a dataset that only contains data from Hungary

Hungary_data <- GDP_per_capita |>
  filter(grepl("HU", id_nuts3)) |>
  na.omit(Hungary_data)
```

```{r}
#| echo: false

# Making a figure using ggplot that shows us variations of GDP per capita across the different NUTS 3 regions in Hungary. 

Hungary_data_plot <- ggplot(Hungary_data, aes(x = year, y = GDP_per_capita, color = id_nuts3)) +
  geom_line() +
  labs(title="Figure 1: GDP per Capita for Hungary", 
       x="Year",
       y="GDP per Capita") +
  theme(legend.position="none")

print(Hungary_data_plot)
```

```{r}
#| echo: false

# Calculate summary statistics for Hungary, chosing only GDP per capita 
summary_stats_hungary <- sapply(Hungary_data["GDP_per_capita"], function(x) c(
  mean = mean(x),
  median = median(x),
  std_dev = sd(x),
  minimum = min(x),
  maximum = max(x)
))

# Print the summary statistics
print(summary_stats_hungary)
```

In Hungary, most of the regions have similar GDP per Capita. One region that sticks out by having a higher value, is the region of Budapest, the capital.

This case also record the mean as higher vale than the median, high standard derivation, and a large gap between minimum and maximum.

### GDP per capita Slovakia

```{r}
#| echo: false
#| output: false

# Making a dataset that only contains data from Slovakia

Slovakia_data <- GDP_per_capita |>
  filter(grepl("SK", id_nuts3)) |>
  na.omit(Slovakia_data)
```

```{r}
#| echo: false

# Making a figure using ggplot that shows us variations of GDP per capita across the different NUTS 3 regions in Slovakia. 

Slovakia_data_plot <- ggplot(Slovakia_data, aes(x = year, y = GDP_per_capita, color = id_nuts3)) +
  geom_line() +
  labs(title="Figure 1: GDP per Capita for Slovakia", 
       x="Year",
       y="GDP per Capita") +
  theme(legend.position="none")

print(Slovakia_data_plot)
```

```{r}
#| echo: false

# Calculate summary statistics for Slovakia, chosing only GDP per capita 
summary_stats_slovakia <- sapply(Slovakia_data["GDP_per_capita"], function(x) c(
  mean = mean(x),
  median = median(x),
  std_dev = sd(x),
  minimum = min(x),
  maximum = max(x)
))

# Print the summary statistics
print(summary_stats_slovakia)
```

Additionally, Slovakia, also have one region with much higher GDP per capita than the rest of the regions. This region is Bratislava, which is the biggest city and the capital, something that might point to this city being the economic centre of Slovakia as well.

Slovakia follows the trend with higher mean than the median, and a large gap between minimum and maximum. In addition, the standard derivation is significantly high, meaning that there is some regions (or one region in this case) that is further away from the rest of the regions in terms of economic development.

### GDP per capita Denmark

```{r}
#| echo: false
#| output: false

# Making a dataset that only contains data from Denmark

Denmark_data <- GDP_per_capita |>
  filter(grepl("DK", id_nuts3)) |>
  na.omit(Denmark_data)
```

```{r}
#| echo: false

# Making a figure using ggplot that shows us variations of GDP per capita across the different NUTS 3 regions in Denmark. 

Denmark_data_plot <- ggplot(Denmark_data, aes(x = year, y = GDP_per_capita, color = id_nuts3)) +
  geom_line() +
  labs(title="Figure 1: GDP per Capita for Denmark", 
       x="Year",
       y="GDP per Capita") +
  theme(legend.position="none")

print(Denmark_data_plot)
```

```{r}
#| echo: false

# Calculate summary statistics for Denmark, chosing only GDP per capita 
summary_stats_denmark <- sapply(Denmark_data["GDP_per_capita"], function(x) c(
  mean = mean(x),
  median = median(x),
  std_dev = sd(x),
  minimum = min(x),
  maximum = max(x)
))

# Print the summary statistics
print(summary_stats_denmark)
```

Lastly, we see similar pattern in Denmark, with the capital Copenhagen being one of the regions with the highest GDP per capita.

Whith mean higher than the median, showing that regions like Copenhagen possible dragging the mean up by population volume.

## Part 1B: Regional Inequity

### Gini Coefficient Calculation

In this part we will compute the population-weighted GDP Gini coefficient for each European NUTS2 region in our assigned countries.

The gini coefficient can help us measure inequality in a distribution, as is therefore a useful tool for us to use when we look at regional inequity. The closer the gini coefficient is to 1, the bigger the inequality is; a number closer to 0 equals equality. When looking at the gini coefficient for NUTS 2 regions, we also get a better overview over differences in income between different regions, and it also makes it easier to find the reasons as to why there is a difference between the regions @hasell2023.

With the use of the NUTS3 GDP per capita data and this formula:

$GINW_j=\frac{1}{2 \bar{y_j}} \sum_{i}^{n_j}\sum_{l}^{n_j}\frac{p_i}{P_j} \frac{p_l}{P_j} |y_i-y_l|$

```{r}
#| echo: false
#| output: false

# Before we can find the Gini coefficient for NUTS2 regions, we have to generate NUTS 2 and 0 identifiers

# Generate NUTS 2 and 0 Identifiers
main_data <- GDP_per_capita |> 
  mutate(
    id_nuts2 = substr(id_nuts3, 1, 4),
    id_nuts0 = substr(id_nuts3, 1, 2)
  ) 
```

```{r}
#| echo: false
#| output: false

# Calculating gini
gini <- main_data |>
  filter(population != 0) |>
  filter(population != "NA") |>
  filter(GDP_per_capita != 0) |>
  filter(GDP_per_capita != "NA") |>
  group_by(id_nuts2, year) |>
  mutate(gini_n2 = gini.wtd(GDP_per_capita, weights = population)) |>
  ungroup()


# Slice function to remove numbers that get repeated. 
gini_nuts_2 <- gini |>
  group_by(id_nuts2, year) |>
  slice(1) |>
  ungroup()

# Since some NUTS 2 and 3 regions are the same (like Copenhagen for example), some gini coefficients will be 0. We should remove them before doing further analysis and data presentation

# Filter data
gini_filtered <- gini_nuts_2 |>
  filter(gini_n2 != 0)
```

After calculating the gini coefficients, we can see that there are some similarities to the data we got from GDP per capita for NUTS 3 regions. In order to see these similarities better, as well as look for other important aspects that can be provided trough the calculations, we will visualize the data in three different ways.

```{r}
#| echo: false

# Creating a bar chart
ggplot(gini_filtered, aes(x = id_nuts2, y = gini_n2, fill = id_nuts0)) +
  geom_bar(stat = "identity") +
  ggtitle("Gini Coefficient by NUTS 2 Region") +
  xlab("NUTS 2 Region ID") +
  ylab("Gini Coefficient") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```{r}
#| echo: false

# Creating a time-series plot
ggplot(gini_filtered, aes(x = year, y = gini_n2, color = id_nuts2)) +
  geom_line() +
  ggtitle("Time-series Plot of Gini Coefficient by NUTS 2 Region") +
  xlab("Year") +
  ylab("Gini Coefficient")
```

```{r}
#| echo: false

# Creating a box plot
ggplot(gini_filtered, aes(x = id_nuts0, y = GDP_per_capita)) +
  geom_boxplot() +
  ggtitle("Distribution of GDP per Capita by Country") +
  xlab("Country") +
  ylab("GDP per Capita")
```

# Cross sectional estimates

## Part 2A: Growth and Inequity

### **Data acquisition**

Firstly, the data is summerised for the year 2010 at the NUTS2 regional level, focusing on economic metrics. Processing the dataset containing the NUTS3 level. Thereafter, computing the total GDP and total population for each NUTS2 region and year. Then, derive the GDP per capita at the NUTS2 level by dividing the total GDP by the total population again. Furthermore, narrowing down the dataset to observations from the year 2010 where the Gini coefficient is positive. Then adding, logarithmic transformations to linearize relationships or to reduce the impact of extreme values.

The next step is making a data frame of NUTS2 2010 and grouping by NUTS0 country level variables, as well as allocating NUTS2 to selected countries. Lastly presenting data in **table XXX** showing a count of NUTS2 regions within each top-level region or country in the 2010 data.

The next step is, estimating a Linear Regression for All Countries using cross sectional data from 2010, NUTS2.

### **Cross Sectional Analysis**

With cross-sectional data analysis we create a snapshot of the year 2010. Cross-sectional data is simpler to manage and interpret than time-series or panel data. With data from only one time point, we avoid complications arising from temporal dynamics. Cross-sectional data allows for the comparison of different regions at the same time, which can be crucial for identifying disparities or differences between the regions [@wooldridge2020].

### **Simple linear regression model**

In this part of the paper, we will carry out a simple regression model and explore the effect of regional economic development, represented by 𝑦𝑗 (GDP per capita), on regional inequality, represented by 𝐺𝐼𝑁 𝐼𝑊𝑗. We will do this to gain an understanding of the connection between economic growth indicators such as GDP per capita and inequality might have. We will explore if higher GDP per capita may lead to less or greater inequality, and gain an understanding to what extent these variables are related.

Unlike the traditional Gini coefficient, which treats all individuals equally regardless of the population size of the region they reside in, the weighted Gini considers the population size of each region, assigning more weight to regions with larger populations.

In the context of regional inequality, this is particularly important because it ensures that the income disparities in more populous regions have a proportionally larger impact on the overall measure of inequality. For instance, if a country has one region with a very high level of income per capita but a small population, and another region with a lower level of income per capita but a large population, the weighted Gini coefficient would reflect the inequality experienced by a larger portion of the country's population, providing a more accurate picture of the national income distribution.

We use simple linear regression to model the relationship with the GINI as the dependent variable and the natural logarithm of GDP per capita as the independent variable. Capturing the relationship between regional development and regional inequality for all regions in 2010.

**Model assumptions**

"The relationship between our dependent and independent variables is linear, ensuring a clear and direct connection between them. Each observation operates independently of the others, emphasizing the unique contribution of every data point. Additionally, we expect homoscedasticity, implying that the variance of the residuals remains consistent regardless of the independent variable's level. It's also crucial that, for any specified value of X, Y maintains a normal distribution. And although more pertinent to multiple regression, it's worth noting the absence of multicollinearity, ensuring that no two predictors are closely correlated."

**Model specification**

$$
Y_i = β_1 + β_2X_i + ε_i
$$

$Y_i$ represent the dependent/ explained variable

$X_i$ represent the independent/ explanatory variable

$β_1$ represent the intercept/ constant

$β_2$ represent the slope coefficient

$ε_i$ represents the residuals or error in the prediction.

**Intercept (**β0​): represents the value of Y when X is 0.

**Slope (**β1​): Indicates the change in Y for a one-unit change in X.

For our model we have:

$GINI = \beta_{0} + \beta_{1} \cdot \text{GDP per capita} + \epsilon$

#### **Goodness of fit**

The goodness of fit in a simple linear regression model measures how well the regression line approximates the real data points. The regression line that best represents the data according to the least squares criterion, which minimizes the sum of the squared vertical distances of the points from the line.

R\^2 is a statistical measure that represents the proportion of the variance for the dependent variable that's explained by the independent variable. It ranges from 0 to 1. A higher R\^2 value indicates a better fit of the model to the data.

R\^2 = 0 The model does not explain any of the variability of the response data around its mean.

R\^2 = 1 The model explains all the variability of the response data around its mean.

If the assumptions for a simple linear regression are met, it indicates a good fit for the model. [Plotting the data can provide a visual indication of the goodness of fit.]{.underline} The points should fall around a straight line without clear patterns in the residuals. As it is crucial to verify these assumptions before proceeding with interpreting the results of the regression analysis.

**Residuals vs. Fitted Values Plot** to check for homoscedasticity and linearity. Ideally, this plot shows no pattern; the residuals are randomly scattered around the horizontal line at zero. If there's a pattern (like a curve or systematic spread of residuals), it suggests non-linearity or heteroscedasticity.

**Normal Q-Q Plot** to check if the residuals are approximately normally distributed. The points should fall roughly along a straight line. Deviations from a straight line suggest deviations from normality.

```{r}
#| echo: false
#| output: false

# Making a dataframe that only contains observations from 2010, we're also filtering the data so that gini is bigger than 0. 

data2010 <- gini_nuts_2 |>
  filter(year == 2010, gini_n2 > 0)
```

```{r}
#| echo: false
#| fig-cap: Regression statistics of all countries for the year 2010

# Finding the natural logarithm of GDP per capita
data2010 <- data2010 |> 
  mutate(log_GDP_per_capita = log(GDP_per_capita))


# lm(y ~ x) y = gini, x = log of GDP per capita, estimation of linear regression model
lm <- lm(gini_n2 ~ log_GDP_per_capita, data = data2010)

# Save coefficients
b0_earn <- lm$coefficients[1]
b1_earn <- lm$coefficients[2]

# Regression statistics by using huxreg
huxreg(All = lm, 
       statistics = c("r.squared","adj.r.squared", "statistic", "p.value"))
```

```{r}
#| echo: false
#| fig-cap: Regression statistics of all countries seperately for the year 2010

# Estimation for each country seperately 
lmSK <- lm(gini_n2 ~ log_GDP_per_capita, subset(data2010, id_nuts0 == "SK"))
lmDK <- lm(gini_n2 ~ log_GDP_per_capita, subset(data2010, id_nuts0 == "DK"))
lmHU <- lm(gini_n2 ~ log_GDP_per_capita, subset(data2010, id_nuts0 == "HU"))
lmPT <- lm(gini_n2 ~ log_GDP_per_capita, subset(data2010, id_nuts0 == "PT"))
lmFR <- lm(gini_n2 ~ log_GDP_per_capita, subset(data2010, id_nuts0 == "FR"))

# Regression statistics
huxreg(SK = lmSK, 
       DK = lmDK, 
       HU = lmHU, 
       PT = lmPT, 
       FR = lmFR, 
       statistics = c("r.squared","adj.r.squared", "statistic", "p.value"))
```

**Model Diagnostics**

We'll now look at some of the numbers we got from the linear regression model (for all countries combined):

-   Coefficients:

    -   Intercept is 0.0551 (expected value of gini when GDP per capita is 0). Statistically significant (indicated by p-value).

    -   Estimated coefficient for GDP per capita is 0.0193, if the natural logarithm of GDP per capita increase by one, then the gini coefficient will increase by 0.0193. The p-value associated with the coefficent is however not statistically significant at 5% level.

-   Goodnes of fit:

    -   Multiple R-squared (0.08028) indicate that around 8% of the variability in the GINI coefficient is explained by the model. This is low, which can suggest that the model dosen't explain the variation in gini.

    -   Adjusted R-squared is even lower (0.05474), is therefore expected that the model dosen't really explain the variance in the dependent variable (gini).

-   Model significance:

    -   The F-statistic (3.142) indicate the significance of the regression model. We can see here, that with the p-value of 0.08474, the model isn't significant at a 5% level.

By looking at these numbers, we can see that the model may not reliably predict the gini coefficient. It also suggest that GDP per capita may not be a valid predictor of the gini coefficient.

We also examined our selected countries seperately in order to see how the reliability and validity of the model might vary between countries. However, since there are too few observations for most of the countries, it makes it hard to make a conclusion of the reliability. What we can see from this examination, is that the models for Denmark, Portugal and Slovakia are not statistically significant. France seem however to have significant coefficiants, and Hungary have a moderate R-squared (but lacks significance in the slope).

**Ordinary Least Squares (OLS) Estimation**

"The OLS method is employed to identify the best-fitting linear relationship between the dependent and independent variables, aiming to minimize the sum of squared residuals. This technique ensures that the estimations of the intercept (β0) and slope (β1) yield the least possible cumulative discrepancy between the actual and predicted values. The strength of OLS lies in its closed-form solution, providing a straightforward computation of coefficients directly from the data-set, without necessitating iterative procedures.

Furthermore, when the classical linear regression assumptions are met, OLS guarantees that the estimators are BLUE, ensuring their unbiasedness and efficiency. This is particularly crucial in econometric analysis, where the precision and reliability of parameter estimates are paramount for policy implications and economic interpretations. The foundation assumptions of linear regression, including linearity, independence, homoscedasticity, and normality of residuals, are prerequisites for OLS to attain these desirable properties. It is imperative, therefore, to conduct diagnostic tests and assess the validity of these assumptions to ensure the robustness of the OLS estimators used in our analysis."

### **Assumptions**

**I. Linearity**

The relationship between the independent variable X and the dependent variable Y is linear. This means that changes in X are associated with proportional changes in Y. A straight line should provide a good fit to the data points when plotted on a graph.

You can create a scatter plot of Y versus X and visually inspect whether a straight line could well represent the relationship. Alternatively, you can plot the residuals versus the fitted values and check for any obvious patterns or non-linearity.

**II. Independence:**

Observations are independent of each other. The value of Y for one observation should not depend on the value of Y for any other observation.

This assumption is more about study design and data collection. Ensure that your observations are not correlated in time or space. For example, if you're analyzing economic data across regions, make sure that the regions are not influencing each other.

**III. Homoscedasticity (Equal Variance):**

The variance of the residuals (the errors) is constant across all levels of X. This means that the spread or "width" of the residuals should remain roughly the same across all values of the independent variable.

A plot of residuals versus fitted values should show a random scatter and not display any funnel-like shapes (wider at one end).

**IV. Normality of Residuals:**

The residuals (the differences between observed and predicted values) are normally distributed. This assumption is particularly important for hypothesis testing and creating confidence intervals.

A Quantile-Quantile (Q-Q) plot of the residuals can show if they follow a normal distribution. The points should fall roughly along a straight line.

**V. No Perfect Multicollinearity (Specific to Multiple Regression)**

In multiple regression settings, this assumes that no independent variable is a perfect linear function of any other independent variables. While this is more pertinent to multiple linear regression, it is crucial there because high correlation between independent variables can lead to unstable coefficient estimates.

Checking the variance inflation factor (VIF) for each variable; a VIF above 5-10 indicates a problematic amount of collinearity.

**Visualization**

```{r}
#| echo: false

# Making two plots, first one is a residuals vs fitted plot, while the other is a normal Q-Q residuals plot
plot(lm, which = 1:2) 
```

We've made two plots that can help us understand the relationship between GDP per capita and the Gini coefficient, and that together with the regression statistics can help with discussing if the classical OLS assumptions hold for the model. The first one is a plot that shows us residuals vs fitted values, which can help us check the homoscedasticity assumption of a linear regression model. The residuals should be randomly scattered around the horisontal 0 line, something that can inducate that the variances of the error terms are constant. In our plot, the residuals are in some extent randomly distributed, and there is also no clear pattern; this suggest that there is likely no significant issues with heteroscedasticity or non-linearity.

The other plot - normal Q-Q plot - is used to assess if the residuals of the linear model are normally distributed. In our plot, most of the points follow the line closely, suggesting that the residuals are normally distributed. There are however some outliers in the tails, that suggest some variation from normality.

In both of these plots, we can see that there are some outliers, these can affect the fit of the model. These outliers might come from regions that have a high GDP per capita compared to rest of the regions, like Paris in France that is a financial hub.

```{r}
#| echo: false
#| label: fig_scatterplot-all
#| cap-location: bottom
#| fig-cap: "Relationship Between GDP per Capita and Gini"

# Visualization of the relationship between GDP per capita and gini
ggplot(data2010, aes(x = log_GDP_per_capita, y = gini_n2)) +
  geom_point(aes(color = log_GDP_per_capita), size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Relationship Between GDP per Capita and Gini",
    x = "GDP per capita",
    y = "Gini",
    caption = "Red line indicates the fitted regression line"
  ) +
  theme_minimal()
```

In this plot we are visualizing the relationship between GDP per capita and gini by using a mix of the two previous plots. We can here as well, see extreme outliers.

## Part 2B: Exploring Other Determinants of Inequity

### I. Data Acquisition

Se data section for more specifications on the added population nut2, transport infrastructure and education.

In order to conduct a Multiple Linear Regression model, we need to have some independent variables to use in the model and compare them with the dependent variable. The first variable, education, can explain income inequality, since it can influence income distribution in a region. If access to education is unequal, then higher education levels might incease income disparities [@rodriguez-pose2008]. The population density, our second variable, can explain inequality since regions with a higher population density might have different economic behaviours. Our last variable, rail network (infrastructure), can influence economic development and accessibility, which also can affect income inequality in a region [@chatterjee2012].

```{r}
#| echo: false
#| output: false
#| label: data acquistion

# Importing datasets

# Data for population density
demo_dens <- read_csv("Raw_data/demo_dens.gz")

# Data for education
educ_data <- read_csv("Raw_data/educ.gz")

# Data for rail network
rail_data <- read_csv("Raw_data/rail.gz")


# Renaming and tidying up the new dataframes 
demo_dens <- demo_dens %>%
  rename(year = TIME_PERIOD, id_nuts2 = geo, pop_density = OBS_VALUE)

educ_data <- educ_data %>%
  rename(year = TIME_PERIOD, id_nuts2 = geo, students_percentage = OBS_VALUE)

rail_data <- rail_data %>%
  rename(year = TIME_PERIOD, id_nuts2 = geo, rail_km = OBS_VALUE)
```

```{r}
#| echo: false
#| output: false

# The NUTS 2 regions in France changed names in 2018. The dataset with education use the old codes while the other datasets use the new codes, we therefore had to change the names in order to be able to merge them together properly. 

# Changing NUTS 2 names for France
nuts2_mapping <- c(
  FR10 = "FR10",
  FR21 = "FRF2",
  FR22 = "FR22",
  FR23 = "FRD2",
  FR24 = "FRC1",
  FR25 = "FRD2",
  FR26 = "FRF2",
  FR30 = "FR22",
  FR41 = "FRF3",
  FR42 = "FRF1",
  FR43 = "FRF3",
  FR51 = "FRG0",
  FR52 = "FRH0",
  FR53 = "FRI3",
  FR61 = "FRI3",
  FR62 = "FRJ2",
  FR63 = "FRI3",
  FR71 = "FRK2",
  FR72 = "FRK1",
  FR81 = "FRJ1",
  FR82 = "FRL0",
  FR83 = "FRM0"
  )

# Adding the new names to the dataset
educ_fixed <- educ_data |>
  mutate(id_nuts2 = recode(id_nuts2, !!!nuts2_mapping))

# Selecting only the necessary columns
demo_dens_selected <- select(demo_dens, year, id_nuts2, pop_density)
educ_selected <- select(educ_fixed, year, id_nuts2, students_percentage)
rail_selected <- select(rail_data, year, id_nuts2, rail_km)

# Merging the datasets
merged_datasets <- demo_dens_selected |>
  left_join(educ_selected, by = c("year", "id_nuts2")) |>
  left_join(rail_selected, by = c("year", "id_nuts2"))

# Filter by year 2010
merged_datasets_2010 <- merged_datasets |>
  filter(year == 2010)

# Merging with dataset containing GDP per capita and gini
Merged_datasets_gini <- merged_datasets_2010 |>
  left_join(data2010, by = c("year", "id_nuts2"))

# cleaning dataset and selecting variables
Merged_datasets_gini <- Merged_datasets_gini |>
  select(year, id_nuts2, id_nuts0, gini_n2, GDP_per_capita, log_GDP_per_capita, students_percentage, pop_density, rail_km)

# Removing NA values from gini_n2 
Merged_datasets_gini <- Merged_datasets_gini |>
  filter(!is.na(gini_n2))

# Remove nuts 2 variables that gets repetead
cleaned_data <- Merged_datasets_gini |>
  distinct(id_nuts2, .keep_all = TRUE)
```

### II. Multiple Linear Regression Model

Multiple Linear Regression (MLR) extends simple linear regression to incorporate multiple explanatory variables, allowing us to examine how multiple factors impact a dependent variable. Choosing a data set from the year 2010 that consists of various regions, with data on each region's economic indicators, demographic variables, and other factors. Our aim is to understand how these variables collectively affect regional inequality.

We will in this part do a Multiple Linear Regression model by using the variables education (in percentage of pupils and students in education, % of total population), population density and rail network in km. This model will tell us if these variables can help explain change in the gini coefficient.

In both our simple linear regression model, and now in our multiple linear regression model, we use the logarithmic function which makes it easier to linearize the relationship between the variables. By using it for GDP per capita, we can reflect changes more effectively. For rail network and population density, the logarithm function ensure that the model capture proportional changes and deals better with the wide range of values.

```{r}
#| echo: false
#| fig-cap: Multiple Linear Regression Model

# Estimations with the help of several independent variables

# To begin with, we'll look at how education can explain the gini coefficient
lm1 <- lm(gini_n2 ~ log_GDP_per_capita + students_percentage, subset(cleaned_data))

# Here we look at how both population density and education can explain the gini coefficient 

lmdens1 <- lm(gini_n2 ~ log_GDP_per_capita + students_percentage + log(pop_density), subset(cleaned_data))

# Lastly, we look at how all of our selected variables, rail, education and population density, can explain the gini coefficient

lm2 <- lm(gini_n2 ~ log_GDP_per_capita + students_percentage + log(pop_density) + log(rail_km), subset(cleaned_data))

# Regression statistics
huxreg("Model" = lm1, 
       "Model 2" = lmdens1, 
       "Model 3" = lm2, 
       statistics = c("r.squared","adj.r.squared", "statistic", "p.value"))
```

### Model specification

**Understanding the Coefficients**

Intercept beta_0 Represents the expected value of the dependent variable when all independent variables are set to zero. Interpretation is often nonsensical in multiple regression if there is no meaningful condition where all predictors are zero.

Slope Coefficients beta_1, beta_2, \..., \\beta_k \\))\*\*: Represent the expected change in the dependent variable for a one-unit change in the respective independent variable, holding all other variables constant.

### III. Model Interpretation

Our first model in the Multiple Linear Regression model examine how education in addition to GDP per capita can help explain the gini coefficient. The second model look at both education, GDP per capita, and population density, while the third model examine them all and also add rail network.

For model 1, the adjusted R-squared is 0.033, indicating that the model explains around 3% of the variability in the gini coefficient. Since this is relatively low, it suggests that model 1 is not suitable in explaining the variance in gini. Both variables have a p-value above 0.05, indicating that they are not statistically significant.

For model 2, the adjusted R-squared is 0.300, which indicate that the model explains around 30% of the variability in the gini coefficient. This is pretty high, suggesting that model 2 is suitable in explaining the variance in gini, meaning that adding population density improves the model's explanatory power. The p-value for population density is less than 0.01, which means that its statistically significant.

The adjusted R-squared for model 3 is 0.370 \~ 37%; this suggest that this model has the greatest fit of all 3 models. Population density is significant at a 0.05 level. The p-value for rail is not below 0.05, and is therefore not statistically significant.

To summarize, we can see that the population density is the variable that affects the gini coeffcient the most. The more people that live in an area, the bigger the economic inequality is.

# Alternative functional forms and panel estimation

By exploring our previous estimates in the relationship between regional development on regional inequality we will estimate the log of GDP per capita in a liner regression model, defining the variables as new determinants on the effects in regional economic development using logarithim of GDP per capita.

Firstly, the data is devided into different subsets. Using France (x) as a binary value also called a dummy variable [@wooldridge2020].

Choosing France as a dummy variable amongst our group of countries could be justified based on several criteria. Firstly, France stands out as one of the largest economies in this group, both in terms of GDP and global economic influence. This distinction makes France a unique case compared to the smaller economies of Denmark, Portugal, Hungary, and Slovakia. Secondly, France's larger geographical area and population size provide different economic dynamics and complexities, which are not as pronounced in the smaller and more homogenous countries like Denmark, Portugal, Hungary, and Slovakia. Thirdly, France's economy is more diversified compared to the other countries listed, which might have more specialized or less varied economic structures. This diversity can lead to different patterns in wealth distribution and economic development. Lastly, France's policies, particularly in social welfare and economic regulation, and its larger domestic market, might influence economic outcomes differently than in the smaller economies, where external trade and different policy contexts play a more significant role.

## Part 3A Testing Development effects across subsets

To elucidate the differences between France and other countries, we employed various analytical methods including descriptive, regression, and comparative analyses. Descriptively, France exhibits a mean Gini coefficient of 0.06960, marginally higher than the 0.062308 average of the other countries, suggesting more pronounced economic inequality. Correspondingly, France's mean GDP per capita is also higher (2.750 compared to 1.743), indicating a higher level of economic development. This juxtaposition of heightened economic inequality and development in France raises intriguing questions, addressed further in our regression analysis.

In the regression analysis of France, the intercept is -0.034 with a statistically significant p-value below 0.001, indicating a non-zero intercept. More notably, the coefficient for the logarithm of GDP per capita stands at 0.110, with a p-value below 0.001, implying a significant increase in the Gini coefficient with rising GDP per capita. This suggests that higher GDP per capita correlates with greater income inequality. The R-squared value of 0.490 indicates that about 49% of the variance in the Gini coefficient is accounted for by GDP per capita, reflecting a strong model fit. This substantial correlation necessitates further investigation into the dynamics linking economic development with inequality in France.

## Part 3B Exploring Alternative Functional Forms

### **The cuznets cuve**

**Logarithmic transformation**

The logarithmic transformation for all the variables allows the coefficients to be interpreted as elasticities, which measure the percentage change in the dependent variable associated with a one percent change in the independent variable [@lessmann2017]. The use of logarithmic transformations is a common practice in econometrics to address issues such as heteroscedasticity and nonlinearity in the data. By using logarithmic transformations, we are able to estimate the relationship between regional inequality and development in a more robust and accurate way [@lessmann2017].

**The quadratic term**

Furthermore the quadratic term in the regression model is used to investigate the relationship between regional inequality and development [@lessmann2017]. The results suggest an inverted U-shaped relationship between income and inequality, which implies that the relationship between inequality and development looks N-shaped instead of U-shaped [@lessmann2017].

**The cubic function**

The cubic function in the regression model is used to investigate the relationship between regional inequality and development. @lessmann2017 suggest that regional inequalities increase again at very high levels of development, which implies that the relationship between inequality and development looks N-shaped instead of U-shaped [@lessmann2017]. The inclusion of a cubic term in a regression model allows the analysis of more complex dynamics, such as increasing or decreasing marginal effects [@wooldridge2020]. However, interpreting these models can be more challenging, as the effect of a one-unit change in the predictor variable on the dependent variable is no longer constant and depends on the level of the predictor variable.

### Functional Form Exploration

```{r}
#| echo: false
#| output: false
# Logarithmic model
log_model <- lm(gini_n2 ~ log(GDP_per_capita), data = gini_filtered)

# Quadratic model
quad_model <- lm(gini_n2 ~ GDP_per_capita + I(GDP_per_capita^2), data = gini_filtered)

# Cubic model
cubic_model <- lm(gini_n2 ~ GDP_per_capita + I(GDP_per_capita^2) + I(GDP_per_capita^3), data = gini_filtered)

# Check the summary of each model
summary(log_model)
```

```{r}
summary(cubic_model)
```

```{r}
summary(quad_model)
```

### Estimation and Visualization

```{r}
#| echo: false
#| output: false
# Quadratic model

# Create a new data frame for plotting predicted values
plot_data <- data.frame(GDP_per_capita = seq(min(gini_filtered$GDP_per_capita), max(gini_filtered$GDP_per_capita), length.out = 250))
plot_data$gini_pred <- predict(quad_model, newdata = plot_data)

# Plotting
ggplot(gini_filtered, aes(x = GDP_per_capita, y = gini_n2)) +
  geom_point(alpha = 0.5) +  # Plot the actual data points
  geom_line(data = plot_data, aes(x = GDP_per_capita, y = gini_pred), color = 'blue') +  # Add the regression line
  labs(title = "Quadratic Model of GDP per Capita and Gini Coefficient",
       x = "GDP per Capita",
       y = "Gini Coefficient") +
  theme_minimal()
```

```{r}
#| echo: false
#| output: false
# Logarithmic model

# Create a new data frame for plotting predicted values
plot_data <- data.frame(GDP_per_capita = seq(min(gini_filtered$GDP_per_capita), max(gini_filtered$GDP_per_capita), length.out = 250))
plot_data$gini_pred <- predict(log_model, newdata = plot_data)

# Plotting
ggplot(gini_filtered, aes(x = GDP_per_capita, y = gini_n2)) +
  geom_point(alpha = 0.5) +  # Plot the actual data points
  geom_line(data = plot_data, aes(x = GDP_per_capita, y = gini_pred), color = 'red') +  # Add the regression line
  scale_x_log10() +  # Logarithmic scale for the x-axis
  labs(title = "Logarithmic Model of GDP per Capita and Gini Coefficient",
       x = "GDP per Capita (log scale)",
       y = "Gini Coefficient") +
  theme_minimal()
```

```{r}
#| echo: false
#| output: false
# Create a new data frame for plotting predicted values
plot_data <- data.frame(GDP_per_capita = seq(min(gini_filtered$GDP_per_capita), max(gini_filtered$GDP_per_capita), length.out = 250))
plot_data$gini_pred <- predict(cubic_model, newdata = plot_data)

# Plotting
ggplot(gini_filtered, aes(x = GDP_per_capita, y = gini_n2)) +
  geom_point(alpha = 0.5) +  # Plot the actual data points
  geom_line(data = plot_data, aes(x = GDP_per_capita, y = gini_pred), color = 'blue') +  # Add the regression line
  labs(title = "Cubic Model of GDP per Capita and Gini Coefficient",
       x = "GDP per Capita",
       y = "Gini Coefficient") +
  theme_minimal()
```

```{r}
#| echo: false
#| output: false
# Calculate residuals
residuals_quad <- gini_filtered$gini_n2 - predict(quad_model, gini_filtered)
residuals_cubic <- gini_filtered$gini_n2 - predict(cubic_model, gini_filtered)
```

```{r}
#| echo: false
#| output: false
# Create a dataframe for plotting residuals
residuals_data <- data.frame(GDP_per_capita = gini_filtered$GDP_per_capita, 
                             Residuals_Quad = residuals_quad, 
                             Residuals_Cubic = residuals_cubic)

# Plotting residuals
ggplot(residuals_data) +
  geom_line(aes(x = GDP_per_capita, y = Residuals_Quad, color = "Quadratic")) +
  geom_line(aes(x = GDP_per_capita, y = Residuals_Cubic, color = "Cubic")) +
  labs(title = "Comparison of Residuals",
       x = "GDP per Capita",
       y = "Residuals") +
  theme_minimal() +
  scale_color_manual(values = c("Quadratic" = "blue", "Cubic" = "red"))
```

```{r}
#| echo: false
#| output: false
sd(residuals_quad)
sd(residuals_cubic)
mean(residuals_quad^2)
mean(residuals_cubic^2)
```

**Results Interpretation**

## Part 3C Hetroskedasticity Testing and causality Discussion

**Causality vs causation**

While correlation indicates a relationship between two variables, it doesn't imply causation. In econometrics, it's a common pitfall to interpret correlation as causality. Panel data helps address this by allowing researchers to control for time-invariant factors and observe changes over time, which can provide stronger evidence for causal relationships.

Panel data analysis helps address endogeneity issues, such as omitted variable bias, which can lead to spurious correlation. By tracking the same units over time, it's possible to differentiate whether a relationship is genuinely causal or merely a correlation coinciding in time.

Overall, panel data analysis is a vital tool in econometrics for distinguishing between causality and correlation. By allowing for control over unobserved heterogeneity and providing a dynamic view of data over time, it offers a more nuanced and accurate understanding of the relationships between variables. This is crucial in econometric research, where the distinction between causality and mere correlation may have significant implications.

**Heteroskedasticity Testing**

```{r}
#| echo: false
#| output: false
#hetro
lm_01 <- lm(gini_n2 ~ GDP_per_capita, data = gini_filtered)
```

```{r}
#| echo: false
#| output: false
# Obtain fitted values and residuals from the model
fitted_values <- fitted(lm_01)
residuals <- resid(lm_01)

# Create the plot
plot(fitted_values, residuals, 
     xlab = "Fitted Values", 
     ylab = "Residuals", 
     main = "Residuals vs Fitted Values for Linear Model",
     pch = 20)
abline(h = 0, col = "blue", lwd = 2) # Add a horizontal line at 0
```

The residuals vs. fitted values plot indicates potential issues with our linear model, which might include heteroskedasticity and model misspecification. The observed patterns and their possible implications, suggests that our model might be missing a nonlinear relationship between the dependent and independent variables. This is a sign of model misspecification, indicating that the current linear model may not be the best fit for our data. The variance in the residuals first increasing, then decreasing, and increasing again, implies that the error terms have non-constant variance, which is a sign of heteroskedasticity. In a well-specified homoscedastic model, the spread of the residuals should be roughly equal across all levels of fitted values.

The sets of disconnected residuals further out could indicate that there are distinct subgroups within our data that are behaving differently. It might suggest that the relationship between the variables differs across these groups or that there are influential outliers or leverage points affecting the model differently in these areas.

The Breusch-Pagan test is used to detect heteroskedasticity in a regression model. The test works by checking if the variances of the errors from the regression are dependent on the values of the independent variables, which would violate one of the key assumptions of ordinary least squares (OLS) regression.

```{r}
#| echo: false
#| output: false
# Breusch-Pagan test for the original linear model
bptest_linear <- bptest(lm_01)

# Breusch-Pagan test for the logarithmic model
bptest_log <- bptest(log_model)

# Breusch-Pagan test for the quadratic model
bptest_quad <- bptest(quad_model)

# Output the test results
print(bptest_linear)
print(bptest_log)
print(bptest_quad)
```

```{r}
#| echo: false
#| output: false
# Calculate robust standard errors for the original linear model
coeftest_lm_01 <- coeftest(lm_01, vcov = vcovHC(lm_01, type = "HC"))

# Calculate robust standard errors for the logarithmic model
coeftest_log_model <- coeftest(log_model, vcov = vcovHC(log_model, type = "HC"))

# Calculate robust standard errors for the quadratic model
coeftest_quad_model <- coeftest(quad_model, vcov = vcovHC(quad_model, type = "HC"))

# Print out the results
print(coeftest_lm_01)
print(coeftest_log_model)
print(coeftest_quad_model)
```

## Part 3D Panel Estimates

Since panel data has a two-dimensional structure, with observations on multiple entities across several time periods. It enables us a more detailed and complex analyses compared to purely cross-sectional or time-series data. The data will then allow us to examine both cross-sectional (differences between subjects at a point in time) and longitudinal (changes within subjects over time) effects. For instance, this approach would be apt for studying how policy changes within a region affect its GDP and inequality levels. Fixed-Effects and Random-Effects Models in panel data analysis help in controlling for unobserved heterogeneity, thereby providing a clearer picture of whether there's a causal relationship.

**Fixed effect models**

Panel data estimation is a method used in econometrics to analyse data that involves observations over multiple time periods. In the context of panel data estimation specifics of fixed-effects and random effect are used. [@lessmann2017] argues that the fixed-effects model is a reasonable approach when the differences between countries (or regions) can be viewed as parametric shifts of the regression function. However, the random-effects model allows for time-invariant unobserved heterogeneity across regions and is more appropriate when the fixed-effects model is too restrictive [@lessmann2017].

**Random-Effects Models**

@lessmann2017 mention the use of a random-effects model to investigate the determinants of within-country changes in inequality. The random-effects model controls for several country-level fixed factors (national income, number of regions, and area) and fixed effects for various country groups [@lessmann2017]. The advantage of the random-effects model is that the expected value of the country-specific effect is zero, which means that there is no need to apply any arbitrary data imputation procedure for the missing intercepts [@lessmann2017]. However, this approach may come at the cost of founding the predictions on a slightly biased coefficient [@lessmann2017]. @lessmann2017 also notes that the major coefficient of interest is not sensitive to applying either a fixed-effects model or a random-effects model with additional country and region information [@lessmann2017].

# Discussion

# References
